/*!
* https://github.com/Starcounter-Jack/Fast-JSON-Patch
* json-patch-duplex.js 0.5.0
* (c) 2013 Joachim Wester
* MIT license
*/
var jsonpatch;!function(a){function b(a,c){switch(typeof a){case"undefined":case"boolean":case"string":case"number":return a===c;case"object":if(null===a)return null===c;if(e(a)){if(!e(c)||a.length!==c.length)return!1;for(var d=0,g=a.length;g>d;d++)if(!b(a[d],c[d]))return!1;return!0}var h=f(c),i=h.length;if(f(a).length!==i)return!1;for(var d=0;i>d;d++)if(!b(a[d],c[d]))return!1;return!0;default:return!1}}function c(a){for(var b,c=0,d=a.length;d>c;){b=a.charCodeAt(c);{if(!(b>=48&&57>=b))return!1;c++}}return!0}function d(a,b){for(var d,f=!1,j=0,k=b.length;k>j;){d=b[j],j++;var l=d.path.split("/"),m=a,n=1,o=l.length;if(void 0===d.value&&("add"===d.op||"replace"===d.op||"test"===d.op))throw new Error("'value' MUST be defined");if(void 0===d.from&&("copy"===d.op||"move"===d.op))throw new Error("'from' MUST be defined");for(;;)if(e(m)){var p;if("-"===l[n])p=m.length;else{if(!c(l[n]))throw new Error("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index");p=parseInt(l[n],10)}if(n++,n>=o){f=h[d.op].call(d,m,p,a);break}m=m[p]}else{var q=l[n];if(void 0!==q){if(q&&-1!=q.indexOf("~")&&(q=q.replace(/~1/g,"/").replace(/~0/g,"~")),n++,n>=o){f=g[d.op].call(d,m,q,a);break}}else if(n++,n>=o){f=i[d.op].call(d,m,q,a);break}m=m[q]}}return f}if(!a.apply){var e,f=function(){return Object.keys?Object.keys:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}}(),g={add:function(a,b){return a[b]=this.value,!0},remove:function(a,b){return delete a[b],!0},replace:function(a,b){return a[b]=this.value,!0},move:function(a,b,c){var e={op:"_get",path:this.from};return d(c,[e]),d(c,[{op:"remove",path:this.from}]),d(c,[{op:"add",path:this.path,value:e.value}]),!0},copy:function(a,b,c){var e={op:"_get",path:this.from};return d(c,[e]),d(c,[{op:"add",path:this.path,value:e.value}]),!0},test:function(a,c){return b(a[c],this.value)},_get:function(a,b){this.value=a[b]}},h={add:function(a,b){if(b>a.length)throw new Error("The specified index MUST NOT be greater than the number of elements in the array.");return a.splice(b,0,this.value),!0},remove:function(a,b){return a.splice(b,1),!0},replace:function(a,b){return a[b]=this.value,!0},move:g.move,copy:g.copy,test:g.test,_get:g._get},i={add:function(a){i.remove.call(this,a);for(var b in this.value)this.value.hasOwnProperty(b)&&(a[b]=this.value[b]);return!0},remove:function(a){for(var b in a)a.hasOwnProperty(b)&&g.remove.call(this,a,b);return!0},replace:function(a){return d(a,[{op:"remove",path:this.path}]),d(a,[{op:"add",path:this.path,value:this.value}]),!0},move:g.move,copy:g.copy,test:function(a){return JSON.stringify(a)===JSON.stringify(this.value)},_get:g._get};e=Array.isArray?Array.isArray:function(a){return a.push&&"number"==typeof a.length},a.apply=d}}(jsonpatch||(jsonpatch={})),"undefined"!=typeof exports&&(exports.apply=jsonpatch.apply);